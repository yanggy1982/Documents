
# LangGraph提供的记忆机制

## 1、概述

### 1.1、LangGraph提供的两种记忆机制

LangGraph提供了两种互补的持久化机制：


| 类型  | 类名            | 存储内容      | 适用场景            | 作用域  |
|-----|---------------|-----------|-----------------|------|
| 短期记忆  | MemorySaver   | 对话历史、执行状态 | 保持当前对话上下文 | 单线程内 | 
| 长期记忆 | InMemoryStore | 用户画像、偏好设置 | 跨会话记住用户信息 | 跨信创  | 

### 1.2、短期记忆

**一、什么是短期记忆**

&nbsp;&nbsp;&nbsp;&nbsp;短期记忆是人工智能系统中最近本的记忆形式，保存着即时上下文（就像一个人记住在对话中刚刚说过的话）。

**二、主要包括**

- **对话历史记录**：最近的消息及其顺序
- **工作记忆**：临时变量和状态
- **注意力上下文**：对话当前的焦点

### 1.3、长期记忆

**一、什么是长期记忆**

&nbsp;&nbsp;&nbsp;&nbsp;长期期记忆是

**二、主要包括**

- **事实记忆**：存储的有关用户、偏好和特定领域信息的知识
- **情景记忆**：过往的交互与经历
- **语义记忆**：对概念及其关系的理解

## 2、短期记忆

### 2.1、常用的短期记忆

#### 一、Memorysaver

例如：

```python
from typing import Annotated, TypedDict
from langgraph.graph import StateGraph
from langgraph.checkpoint.memory import MemorySaver
from langgraph.graph.message import add_messages

class State(TypedDict):
    messages: Annotated[list, add_messages]

checkpointer = MemorySaver() 
builder = StateGraph(State)

graph = builder.compile(
    checkpointer=checkpointer,
)
```

#### 二、PostgresSaver

**（一）安装**

```shell
pip install -U "psycopg[binary,pool]" langgraph-checkpoint-postgres
```

**（二）使用**

- 同步



- 异步



#### 三、MongoDBSaver

#### 四、RedisSaver



## 3、长期记忆

### 3.1、常用的长期记忆

- InMemoryStore

例如：

```python
from typing import Annotated, TypedDict
from langgraph.graph import StateGraph
from langgraph.checkpoint.memory import MemorySaver
from langgraph.store.memory import InMemoryStore
from langgraph.graph.message import add_messages

class State(TypedDict):
    messages: Annotated[list, add_messages]

# 短期记忆：每个thread独立
checkpointer = MemorySaver() 

# 长期记忆：跨thread共享
store = InMemoryStore()

builder = StateGraph(State)
graph = builder.compile(
    checkpointer=checkpointer,
    store=store
)
```

## 4、短期记忆管理





## 5、与外部记忆的结合

### 5.1、常用的外部记忆组件

| 组件   |
|------|
| LangMem |
| Mem0 |














